"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[642,5341,3333],{90642:function(e,t,n){n.r(t),n.d(t,{default:function(){return b}});var i=n(85893);let r=n(10508).ZP.div(['&.drop{&::before{color:#f1f1f1;content:"Drop rom file here";display:flex;font-size:16px;font-weight:600;height:100%;left:0;place-content:center;place-items:center;position:absolute;top:0;width:100%;}}']);var a=n(1864),l=n(67294),o=n(52757),c=n(96189),s=n(44696),u=n(20063),d=n(58437),f=n(97836),m=n(6484),w=n(5341),p=n(48764).Buffer;let v=e=>Object.entries(o.P).find(([,{ext:t}])=>t.includes(e))||[];var h=({containerRef:e,id:t,loading:n,setLoading:i,url:r})=>{let{exists:o,mkdirRecursive:h,readFile:S,updateFolder:b,writeFile:y}=(0,u.o)(),E=(0,c.Z)(),{linkElement:g,processes:{[t]:{closing:F=!1,libs:$=[]}={}}={}}=(0,d.z)(),{prependFileToTitle:_}=(0,s.Z)(t),x=(0,l.useRef)(),T=(0,l.useRef)(""),Z=(0,l.useCallback)(async()=>{var t,n,l;if(!r)return;if(null===(t=e.current)||void 0===t||t.classList.remove("drop"),T.current){if(T.current!==r){T.current="";try{null===(n=(l=window).EJS_terminate)||void 0===n||n.call(l)}catch{}if(e.current){let t=document.createElement("div");t.id="emulator",[...e.current.children].forEach(e=>e.remove()),e.current.append(t),Z()}}return}T.current=r,window.EJS_gameName=(0,a.basename)(r,(0,a.extname)(r));let[c,{core:s="",zip:u=!1}={}]=v((0,m.RT)(r)),d=await S(r);window.EJS_gameUrl=(0,m.YS)(u?p.from(await (0,w.zipAsync)({[(0,a.basename)(r)]:d})):d),window.EJS_core=s;let g=`${(0,a.basename)(r)}.sav`,F=(0,a.join)(f.Tl,g);window.EJS_onGameStart=({detail:{emulator:e}})=>{(async()=>{if(await o(F)){var t;null===(t=e.loadState)||void 0===t||t.call(e,await S(F))}i(!1),E(window.FS,"EmulatorJs"),x.current=e})()},window.EJS_onSaveState=({screenshot:e,state:t})=>{var n,i;null===(n=(i=window).EJS_terminate)||void 0===n||n.call(i);let r=async()=>{if(await o(f.Tl)||await h(f.Tl),await y(F,p.from(t),!0)){let t=(0,a.join)(f.Xo,f.Tl),n=(0,a.join)(f.Xo,`${F}${f.Qy}`);await o(t)||(await h(t),b((0,a.dirname)(f.Tl))),await y(n,p.from(e),!0),b(f.Tl,g)}};t&&r()},window.EJS_player="#emulator",window.EJS_biosUrl="",window.EJS_pathtodata="Program Files/EmulatorJs/",window.EJS_startOnLoaded=!0,window.EJS_RESET_VARS=!0,window.EJS_Buttons={cacheManage:!1,loadState:!1,quickLoad:!1,quickSave:!1,saveState:!1,screenRecord:!1,screenshot:!1},await (0,m.mb)($,void 0,!0),_(`${window.EJS_gameName} (${c})`)},[e,o,$,h,E,_,S,i,b,r,y]);(0,l.useEffect)(()=>{if(r)Z();else{var t;i(!1),E(window.FS,"EmulatorJs"),null===(t=e.current)||void 0===t||t.classList.add("drop")}},[e,Z,E,i,r]),(0,l.useEffect)(()=>{if(!n){var i;let n=null===(i=e.current)||void 0===i?void 0:i.querySelector("canvas");n instanceof HTMLCanvasElement&&g(t,"peekElement",n)}return()=>{if(!n&&F){var e,t;null===(t=x.current)||void 0===t||null===(e=t.elements.buttons.saveState)||void 0===e||e.click()}}},[F,e,t,g,n])},S=n(7443),b=({id:e})=>(0,i.jsx)(S.Z,{StyledComponent:r,id:e,useHook:h,children:(0,i.jsx)("div",{id:"emulator"})})},7443:function(e,t,n){var i=n(85893),r=n(67294),a=n(33333),l=n(45279),o=n(58437);t.Z=(0,r.memo)(({id:e,useHook:t,StyledComponent:n,children:c})=>{let{processes:{[e]:{url:s=""}={}}}=(0,o.z)(),u=(0,r.useRef)(null),[d,f]=(0,r.useState)(!0),m=(0,r.useMemo)(()=>({contain:"strict",visibility:d?"hidden":"visible"}),[d]);return t({containerRef:u,id:e,loading:d,setLoading:f,url:s}),(0,i.jsxs)(i.Fragment,{children:[d&&(0,i.jsx)(a.default,{}),(0,i.jsx)(n,{ref:u,style:m,...(0,l.Z)({id:e}),children:c})]})})},33333:function(e,t,n){n.r(t);let i=n(10508).ZP.div(['cursor:wait;height:100%;width:100%;&::before{color:#fff;content:"Working on it...";display:flex;font-size:12px;justify-content:center;mix-blend-mode:difference;padding-top:18px;}']);t.default=i},96189:function(e,t,n){var i=n(67294),r=n(20063);t.Z=()=>{let{mountEmscriptenFs:e,unMapFs:t,updateFolder:n}=(0,r.o)(),a=(0,i.useRef)();return(0,i.useEffect)(()=>()=>{if(a.current){let e=a.current;a.current="",t(e,!0).then(()=>n("/",void 0,e)).catch(()=>{})}},[t,n]),(0,i.useCallback)(async(t,i)=>{if(!t)return;let r="";try{r=await e(t,i)}catch{}r&&(n("/",r),a.current=r)},[e,n])}},45279:function(e,t,n){var i=n(1864),r=n(67294),a=n(59746),l=n(23736),o=n(89670),c=n(20063),s=n(58437),u=n(76488),d=n(97836),f=n(6484);t.Z=({callback:e,directory:t=d.Ll,id:n,onDragLeave:m,onDragOver:w,updatePositions:p})=>{let{url:v}=(0,s.z)(),{iconPositions:h,sortOrders:S,setIconPositions:b}=(0,u.k)(),{exists:y,mkdirRecursive:E,updateFolder:g,writeFile:F}=(0,c.o)(),$=(0,r.useCallback)(async(e,t,r)=>{if(n){if(t){let a=(0,i.join)(d.Ll,e);if(await E(d.Ll),await F(a,t,!0))return r===o.v.UPDATE_URL&&v(n,a),g(d.Ll,e),(0,i.basename)(a)}else r===o.v.UPDATE_URL&&v(n,e)}return""},[n,E,g,v,F]),{openTransferDialog:_}=(0,a.Z)();return{onDragLeave:m,onDragOver:e=>{null==w||w(e),(0,f.nK)(e)},onDrop:r=>{if(!d.my.has((0,f.RT)(t))){if(p&&r.target instanceof HTMLElement){let{files:e,text:n}=(0,l.p4)(r);if(0===e.length&&""===n)return;let a={x:r.clientX,y:r.clientY},o=[];if(n){try{o=JSON.parse(n)}catch{}if(!Array.isArray(o))return;let[e]=o;if(!e||e.startsWith(t)&&(0,i.basename)(e)===(0,i.relative)(t,e))return;o=o.map(e=>(0,i.basename)(e))}else e instanceof FileList?o=[...e].map(e=>e.name):o=[...e].map(e=>{var t;return(null===(t=e.getAsFile())||void 0===t?void 0:t.name)||""}).filter(Boolean);o=o.map(e=>{if(!h[`${t}/${e}`])return e;let n=0,r="";do n+=1,r=`${t}/${(0,i.basename)(e,(0,i.extname)(e))} (${n})${(0,i.extname)(e)}`;while(h[r]);return(0,i.basename)(r)}),(0,f.vi)(t,r.target,h,S,a,o,b,y)}(0,l.WG)(r,e||$,t,_,!!n)}}}}},44696:function(e,t,n){var i=n(67294),r=n(58437),a=n(37176),l=n(97836);t.Z=e=>{let{title:t}=(0,r.z)(),[n]=e.split(l.CC),{title:o}=a.Z[n]||{};return{appendFileToTitle:(0,i.useCallback)((n,i)=>{let r=n?` - ${n}${i?` ${l.xy}`:""}`:"";t(e,`${o}${r}`)},[e,o,t]),prependFileToTitle:(0,i.useCallback)((n,i,r)=>{let a=n?`${i?`${l.xy} `:""}${n}${r?" ":" - "}`:"";t(e,`${a}${o}`)},[e,o,t])}}},5341:function(e,t,n){n.d(t,{addEntryToZippable:function(){return c},addFileToZip:function(){return d},createZippable:function(){return o},isFileInZip:function(){return f},unarchive:function(){return m},unzip:function(){return s},zipAsync:function(){return u}});var i=n(1864),r=n(6484),a=n(97836),l=n(48764).Buffer;let o=(e,t)=>e.split("/").reduceRight((e,t)=>({[t]:e}),[t,a.BF]),c=(e,t)=>{let[[n,i]]=Object.entries(t);return e[n]=n in e?c(e[n],t[n]):i,e},s=e=>new Promise((t,i)=>{n.e(3778,"high").then(n.bind(n,93778)).then(({unzip:n})=>n(e,(e,n)=>e?i(e):t(n)))}),u=(e,t=a.BF)=>new Promise((i,r)=>{n.e(3778,"high").then(n.bind(n,93778)).then(({zip:n})=>n(e,t,(e,t)=>e?r(e):i(t)))}),d=async(e,t,n,i)=>l.from(await u(c(e.length>0&&await s(e)||{},o(n,await i(t))))),f=(e,t)=>new Promise((i,r)=>{n.e(3778,"high").then(n.bind(n,93778)).then(({unzip:n})=>n(e,(e,n)=>e?r(e):i(Object.keys(n).includes(t))))}),m=async(e,t)=>{if(window.SevenZip||await (0,r.mb)(["System/7zip/7zz.es6.js"]),!window.SevenZip)return{};let n=await window.SevenZip(),a=(0,i.basename)(e),o=(0,i.join)("/",(0,i.basename)(e,(0,i.extname)(e)));n.FS.mkdir(o),n.FS.chdir(o);let c=n.FS.open(a,"w+");n.FS.write(c,t,0,t.length),n.FS.close(c),n.callMain(["-y","x",a]);let s=n.FS.readdir(o),u=e=>(t,r)=>{if([".","..",a].includes(r))return t;let c=(0,i.join)(e,r),s=c.replace(o,"");try{n.FS.chmod(c,511)}catch{}return Object.assign(t,n.FS.isDir(n.FS.stat(c).mode)?{[(0,i.join)(s,"/")]:l.from(""),...n.FS.readdir(c).reduce(u(c),{})}:{[s]:n.FS.readFile(c,{flags:"r"})}),t};return s.reduce(u(o),{})}}}]);