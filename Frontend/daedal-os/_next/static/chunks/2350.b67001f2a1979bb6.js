"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2350,3333],{82350:function(e,t,i){i.r(t),i.d(t,{default:function(){return C}});var n=i(85893);let r=i(10508).ZP.div(['canvas{background-color:#000;height:auto !important;width:auto !important;}div{font-family:"Liberation Mono","DejaVu Sans Mono","Courier New",monospace;font-size:14px;font-weight:700;line-height:normal;position:relative;white-space:pre;}']);var a=i(1864),o=i(67294);let l={autostart:!0,bios:{url:"/daedal-os/Program Files/Virtual x86/bios/seabios.bin"},log_level:0,network_relay_url:"wss://relay.widgetry.org/",vga_bios:{url:"/daedal-os/Program Files/Virtual x86/bios/vgabios.bin"},wasm_path:"/daedal-os/Program Files/Virtual x86/v86.wasm"},s=".bin.save",u=new Set([160,180,200,320,360,400,720,1200,1440,1722,2880]),c=e=>u.has(e>>10)&&(1023&e)==0||512===e,d=(e,t)=>".bin"===e?"bzimage":c(t)?"fda":"hda";var f=i(48010);let h="screen-set-size-graphical",p="screen-set-size-text";var m=(e,t,i)=>{let{updateWindowSize:n}=(0,f.Z)(e);(0,o.useEffect)(()=>{let e=([e,t])=>n(t,e),r=([,e])=>{var i,r;let{height:a,width:o}=(null===(r=t.current)||void 0===r?void 0:null===(i=r.querySelector("span:last-of-type"))||void 0===i?void 0:i.getBoundingClientRect())||{};a&&o&&n(e*a,o)};return null==i||i.add_listener(h,e),null==i||i.add_listener(p,r),()=>{null==i||i.remove_listener(h,e),null==i||i.remove_listener(p,r)}},[i,t,n])},v=i(44696),g=i(20063),b=i(46508),w=i(58437),x=i(76488),y=i(97836),_=i(6484),T=i(48764).Buffer;window.DEBUG=!1;var $=({containerRef:e,id:t,loading:i,setLoading:n,url:r})=>{let{processes:{[t]:u}}=(0,w.z)(),{foregroundId:c}=(0,x.k)(),{closing:f,libs:h=[]}=u||{},{appendFileToTitle:p}=(0,v.Z)(t),$=(0,o.useRef)(!1),[z,C]=(0,o.useState)({}),{exists:k,mkdirRecursive:L,readFile:E,updateFolder:R,writeFile:M}=(0,g.o)(),S=(0,o.useCallback)(e=>new Promise((t,i)=>{var n;null===(n=z[e])||void 0===n||n.save_state().then(t).catch(i)}),[z]),j=(0,o.useCallback)(async(e,t)=>{let i=`${(0,a.basename)(e)}${s}`;await k(y.Tl)||(await L(y.Tl),R((0,a.dirname)(y.Tl)));let n=(0,a.join)(y.Tl,i);if(await M(n,T.from(await S(e)),!0)){if(t){let e=(0,a.join)(y.Xo,y.Tl),i=(0,a.join)(y.Xo,`${n}${y.Qy}`);await k(e)||(await L(e),R((0,a.dirname)(y.Tl))),await M(i,t,!0)}try{var r;null===(r=z[e])||void 0===r||r.destroy()}catch{}finally{R(y.Tl,i)}}},[z,k,L,S,R,M]),Z=(0,o.useCallback)(async()=>{var t;let[i]=Object.keys(z);i&&await j(i);let n=r?await E(r):T.from(""),o=(0,_.RT)(r),u=".iso"===o,c=(0,_.YS)(n),f={[u?"cdrom":d(o,n.length)]:{async:!1,size:n.length,url:c,use_parts:!1}},{deviceMemory:h=.25}=navigator,m={boot_order:u?531:561,memory_size:134217728*h,screen_container:e.current,vga_memory_size:8388608*h,...f,...l},v=(0,a.join)(y.Tl,`${(0,a.basename)(r)}${s}`),g=await k(v)?(0,_.YS)(await E(v)):void 0;g&&(m.initial_state={url:g}),m.filesystem={basefs:URL.createObjectURL(new Blob([JSON.stringify((0,b.uh)())],{type:"application/json"})),baseurl:(null===(t=window.location)||void 0===t?void 0:t.origin)??"/"};let w=new window.V86Starter(m);w.add_listener("emulator-loaded",()=>{var t;if($.current){w.destroy();return}p((0,a.basename)(r)),(0,_.EK)(c),m.initial_state&&(0,_.EK)(m.initial_state.url),m.filesystem&&(0,_.EK)(m.filesystem.basefs),null===(t=e.current)||void 0===t||t.addEventListener("click",w.lock_mouse),C({[r]:w})})},[p,j,e,z,k,E,r]);m(t,e,z[r]),(0,o.useEffect)(()=>{i&&(0,_.mb)(h).then(()=>{window.V86Starter&&n(!1)})},[h,i,n]),(0,o.useEffect)(()=>{let e=c===t;Object.values(z).forEach(t=>null==t?void 0:t.keyboard_set_status(e))},[z,c,t]),(0,o.useEffect)(()=>{!u||f||i||r in z||(C({[r]:void 0}),Z());let t=e.current;return()=>{if(r&&f&&!$.current&&($.current=!0,z[r])){let e=e=>{window.setTimeout(()=>j(r,e),y.jx.WINDOW)};(async()=>{var e,i;let n;if(null===(e=z[r])||void 0===e?void 0:e.v86.cpu.devices.vga.graphical_mode)n=null==t?void 0:null===(i=t.querySelector("canvas"))||void 0===i?void 0:i.toDataURL("image/png");else if(t instanceof HTMLElement){let e=await (0,_.mZ)();try{n=await (null==e?void 0:e.toPng(t,{skipAutoScale:!0}))}catch{}}return n?T.from(n.replace("data:image/png;base64,",""),"base64"):void 0})().then(e).catch(e)}}},[j,f,e,z,Z,i,u,r])},z=i(7443),C=({id:e})=>(0,n.jsxs)(z.Z,{StyledComponent:r,id:e,useHook:$,children:[(0,n.jsx)("div",{onContextMenuCapture:_.nK}),(0,n.jsx)("canvas",{onContextMenuCapture:_.nK})]})},7443:function(e,t,i){var n=i(85893),r=i(67294),a=i(33333),o=i(45279),l=i(58437);t.Z=(0,r.memo)(({id:e,useHook:t,StyledComponent:i,children:s})=>{let{processes:{[e]:{url:u=""}={}}}=(0,l.z)(),c=(0,r.useRef)(null),[d,f]=(0,r.useState)(!0),h=(0,r.useMemo)(()=>({contain:"strict",visibility:d?"hidden":"visible"}),[d]);return t({containerRef:c,id:e,loading:d,setLoading:f,url:u}),(0,n.jsxs)(n.Fragment,{children:[d&&(0,n.jsx)(a.default,{}),(0,n.jsx)(i,{ref:c,style:h,...(0,o.Z)({id:e}),children:s})]})})},33333:function(e,t,i){i.r(t);let n=i(10508).ZP.div(['cursor:wait;height:100%;width:100%;&::before{color:#fff;content:"Working on it...";display:flex;font-size:12px;justify-content:center;mix-blend-mode:difference;padding-top:18px;}']);t.default=n},45279:function(e,t,i){var n=i(1864),r=i(67294),a=i(59746),o=i(23736),l=i(89670),s=i(20063),u=i(58437),c=i(76488),d=i(97836),f=i(6484);t.Z=({callback:e,directory:t=d.Ll,id:i,onDragLeave:h,onDragOver:p,updatePositions:m})=>{let{url:v}=(0,u.z)(),{iconPositions:g,sortOrders:b,setIconPositions:w}=(0,c.k)(),{exists:x,mkdirRecursive:y,updateFolder:_,writeFile:T}=(0,s.o)(),$=(0,r.useCallback)(async(e,t,r)=>{if(i){if(t){let a=(0,n.join)(d.Ll,e);if(await y(d.Ll),await T(a,t,!0))return r===l.v.UPDATE_URL&&v(i,a),_(d.Ll,e),(0,n.basename)(a)}else r===l.v.UPDATE_URL&&v(i,e)}return""},[i,y,_,v,T]),{openTransferDialog:z}=(0,a.Z)();return{onDragLeave:h,onDragOver:e=>{null==p||p(e),(0,f.nK)(e)},onDrop:r=>{if(!d.my.has((0,f.RT)(t))){if(m&&r.target instanceof HTMLElement){let{files:e,text:i}=(0,o.p4)(r);if(0===e.length&&""===i)return;let a={x:r.clientX,y:r.clientY},l=[];if(i){try{l=JSON.parse(i)}catch{}if(!Array.isArray(l))return;let[e]=l;if(!e||e.startsWith(t)&&(0,n.basename)(e)===(0,n.relative)(t,e))return;l=l.map(e=>(0,n.basename)(e))}else e instanceof FileList?l=[...e].map(e=>e.name):l=[...e].map(e=>{var t;return(null===(t=e.getAsFile())||void 0===t?void 0:t.name)||""}).filter(Boolean);l=l.map(e=>{if(!g[`${t}/${e}`])return e;let i=0,r="";do i+=1,r=`${t}/${(0,n.basename)(e,(0,n.extname)(e))} (${i})${(0,n.extname)(e)}`;while(g[r]);return(0,n.basename)(r)}),(0,f.vi)(t,r.target,g,b,a,l,w,x)}(0,o.WG)(r,e||$,t,z,!!i)}}}}},918:function(e,t,i){i.d(t,{BS:function(){return o},FC:function(){return r},F_:function(){return n},wV:function(){return a}});let n={bottom:!1,bottomLeft:!1,bottomRight:!1,left:!1,right:!1,top:!1,topLeft:!1,topRight:!1},r={bottom:!0,bottomLeft:!0,bottomRight:!0,left:!0,right:!0,top:!0,topLeft:!0,topRight:!0},a=30,o=166,l={cancel:".cancel",dragHandleClassName:"handle",enableUserSelectHack:!1,minHeight:`${a}px`,minWidth:`${o}px`,resizeHandleStyles:{bottom:{bottom:"-3px",cursor:"ns-resize",height:"6px"},bottomLeft:{bottom:"-3px",cursor:"nesw-resize",height:"12px",left:"-3px",width:"12px"},bottomRight:{bottom:"-3px",cursor:"nwse-resize",height:"12px",right:"-3px",width:"12px"},left:{cursor:"ew-resize",left:"-3px",width:"6px"},right:{cursor:"ew-resize",right:"-3px",width:"6px"},top:{cursor:"ns-resize",height:"6px",top:"-3px"},topLeft:{cursor:"nwse-resize",height:"12px",left:"-3px",top:"-3px",width:"12px"},topRight:{cursor:"nesw-resize",height:"12px",right:"-3px",top:"-3px",width:"12px"}}};t.ZP=l},38365:function(e,t,i){i.d(t,{Rf:function(){return l},b$:function(){return c},hu:function(){return o},ix:function(){return u},mZ:function(){return s}});var n=i(918),r=i(97836),a=i(6484);let o=(e,t,i=[],n=0)=>{let[o]=e.split(r.CC),l=`${o}${r.CC}`,s=i.find(e=>e.startsWith(l))||"",{componentWindow:u}=(null==t?void 0:t[s])||{},{x:c=0,y:d=0,width:f=0,height:h=0}=(null==u?void 0:u.getBoundingClientRect())||{};return!(c+n+f>(0,a.E9)()||d+n+h>(0,a.sI)())&&(c||d)?{x:c+n,y:d+n}:void 0},l=({height:e,width:t})=>{let[i,n]=[(0,a.sI)(),(0,a.E9)()];return{x:Math.floor(n/2-(0,a.Vy)(t)/2),y:Math.floor((i-r.bK)/2-(0,a.Vy)(e)/2)}},s={BOTTOM:15,LEFT:150,RIGHT:50,TOP:15},u=(e,t,i=!1)=>{let{position:n,size:r}=e||{},{x:o=0,y:l=0}=n||{},{height:u=0,width:c=0}=r||{};return i?o+s.RIGHT>t.x||o+(0,a.Vy)(c)-s.LEFT<0||l+s.BOTTOM>t.y||l+s.TOP<0:o<0||l<0||o+(0,a.Vy)(c)>t.x||l+(0,a.Vy)(u)>t.y},c=(e,t)=>{let i=Number(e.height),o=Number(e.width),[l,s]=[(0,a.sI)(),(0,a.E9)()],u=l-r.bK,c=Math.max(n.wV,Math.min(i,u)),d=Math.max(n.BS,Math.min(o,s));if(!t)return{height:c,width:d};let f=i===c,h=o===d;return f||h?f?h?{height:c,width:d}:{height:Math.round(c/(o/d)),width:d}:{height:c,width:Math.round(d/(i/c))}:i>o?{height:c,width:Math.round(d/(u/c))}:{height:Math.round(c/(s/d)),width:d}}},44696:function(e,t,i){var n=i(67294),r=i(58437),a=i(37176),o=i(97836);t.Z=e=>{let{title:t}=(0,r.z)(),[i]=e.split(o.CC),{title:l}=a.Z[i]||{};return{appendFileToTitle:(0,n.useCallback)((i,n)=>{let r=i?` - ${i}${n?` ${o.xy}`:""}`:"";t(e,`${l}${r}`)},[e,l,t]),prependFileToTitle:(0,n.useCallback)((i,n,r)=>{let a=i?`${n?`${o.xy} `:""}${i}${r?" ":" - "}`:"";t(e,`${a}${l}`)},[e,l,t])}}},48010:function(e,t,i){var n=i(10508),r=i(67294),a=i(38365),o=i(58437),l=i(76488);t.Z=e=>{let{setWindowStates:t}=(0,l.k)(),{processes:{[e]:{lockAspectRatio:i=!1,maximized:s=!1}={}}={}}=(0,o.z)(),{sizes:{titleBar:u}}=(0,n.Fg)();return{updateWindowSize:(0,r.useCallback)((n,r)=>t(t=>({...t,[e]:{...null==t?void 0:t[e],maximized:s,size:(0,a.b$)({height:n+u.height,width:r},i)}})),[e,i,s,t,u.height])}}}}]);