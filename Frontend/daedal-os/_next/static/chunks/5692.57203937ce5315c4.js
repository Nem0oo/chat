"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5692,4609],{55692:function(e,t,n){n.r(t),n.d(t,{default:function(){return z}});var r=n(85893),a=n(1864),i=n(67294);let l=(0,i.memo)(()=>(0,r.jsx)("svg",{viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M30 2v10h-2V5.422L5.422 28H12v2H2V20h2v6.578L26.578 4H20V2h10z"})})),s=(0,i.memo)(()=>(0,r.jsx)("svg",{viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M4 18h10v10h-2v-6.578L1.453 31.953.047 30.547 10.578 20H4v-2zm17.422-6H28v2H18V4h2v6.578L30.547.047l1.406 1.406z"})})),o=(0,i.memo)(()=>(0,r.jsx)("svg",{viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M31.703 30.297Q32 30.594 32 31t-.297.703T31 32t-.703-.297l-12.266-12.25q-1.5 1.234-3.289 1.891T11 22q-1.516 0-2.922-.391T5.453 20.5t-2.227-1.727-1.727-2.227T.39 13.921t-.391-2.922.391-2.922 1.109-2.625 1.727-2.227 2.227-1.727T8.078.389 11-.002t2.922.391 2.625 1.109 2.227 1.727 1.727 2.227 1.109 2.625.391 2.922q0 1.953-.656 3.742t-1.891 3.289zM11 20q1.859 0 3.5-.711t2.859-1.93 1.93-2.859T20 11t-.711-3.5-1.93-2.859-2.859-1.93T11 2t-3.5.711-2.859 1.93T2.711 7.5 2 11t.711 3.5 1.93 2.859 2.859 1.93T11 20zm1-10h4v2h-4v4h-2v-4H6v-2h4V6h2v4z"})})),u=(0,i.memo)(()=>(0,r.jsx)("svg",{viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M32 30.906q0 .438-.266.766T31 32q-.406 0-.703-.297l-12.266-12.25q-1.5 1.234-3.289 1.891T11 22q-1.516 0-2.922-.391T5.453 20.5t-2.227-1.727-1.727-2.227T.39 13.921t-.391-2.922.391-2.922 1.109-2.625 1.727-2.227 2.227-1.727T8.078.389 11-.002t2.922.391 2.625 1.109 2.227 1.727 1.727 2.227 1.109 2.625.391 2.922q0 1.953-.656 3.742t-1.891 3.289q.234.234.898.891t1.594 1.563 2.031 1.992 2.219 2.203 2.164 2.18 1.859 1.922 1.297 1.43.484.695zM11 20q1.859 0 3.5-.711t2.859-1.93 1.93-2.859T20 11t-.711-3.5-1.93-2.859-2.859-1.93T11 2t-3.5.711-2.859 1.93T2.711 7.5 2 11t.711 3.5 1.93 2.859 2.859 1.93T11 20zM6 10h10v2H6v-2z"})}));var c=n(10508);let h="48px",d="32px",f=c.ZP.div(["background-color:#222;display:flex;height:100%;padding-bottom:",";padding-top:",";position:relative;svg{fill:#fff;}figure{display:flex;height:100%;margin:0 "," ",";overflow:hidden;place-content:center;place-items:center;width:100%;div{color:rgb(167,167,167);font-size:13px;padding:0 38px;text-align:center;}img{display:",";max-height:100%;max-width:100%;}}nav{display:flex;height:",";place-content:center;place-items:center;position:absolute;&.top{top:0;width:100%;svg{height:16px;}}&.bottom{bottom:0;right:0;svg{height:20px;margin-top:2px;}}button{height:",";width:",";&:disabled{pointer-events:none;svg{fill:rgb(125,125,125);}}&:hover{background-color:rgba(75,75,75,50%);}&:active{background-color:rgba(100,100,100,50%);}}}"],d,h,d,d,({$showImage:e})=>e?"block":"none",h,h,h);var m=n(57631),v=n(72490),g=n(58437),p=n(44696);let w={cursor:"default",maxScale:7,minScale:1,panOnlyWhenZoomed:!0,step:.1};var x=(e,t,n)=>{let[r,l]=(0,i.useState)(),{getScale:s,reset:o,zoomIn:u,zoomOut:c,zoomToPoint:h,zoomWithWheel:d}=r||{},{processes:{[e]:f}}=(0,g.z)(),{closing:x,componentWindow:b,url:y=""}=f||{},{prependFileToTitle:T}=(0,p.Z)(e),L=(0,i.useCallback)(e=>{let{detail:{scale:t=0,x:n=0,y:i=0}={}}=e||{};if(y&&t){let{minScale:e,step:l}=w,s=t<e+l;s&&(n||i)&&window.setTimeout(()=>null==r?void 0:r.reset(),50),x||T(s?(0,a.basename)(y):`${(0,a.basename)(y)} (${Math.floor(100*t)}%)`)}},[x,r,T,y]),j=(0,i.useCallback)(e=>null==d?void 0:d(e,{step:.3}),[d]);return(0,v.Z)(b,o),(0,i.useEffect)(()=>(t&&n&&(t.addEventListener("panzoomchange",L),n.addEventListener("wheel",j)),()=>{null==t||t.removeEventListener("panzoomchange",L),null==n||n.removeEventListener("wheel",j)}),[n,t,L,j]),(0,i.useEffect)(()=>(t&&!r&&l((0,m.Z)(t,w)),()=>null==r?void 0:r.destroy()),[t,r]),{reset:o,scale:null==s?void 0:s(),zoomIn:u,zoomOut:c,zoomToPoint:h}},b=n(45279),y=n(20063),T=n(8955),L=n(24645),j=n(67278),E=n(97836),k=n(6484),C=n(14609);let{maxScale:$,minScale:Z}=w;var z=({id:e})=>{let{processes:{[e]:t}={},url:n}=(0,g.z)(),{componentWindow:c,closing:h=!1,url:d=""}=t||{},[m,v]=(0,i.useState)({}),[w,z]=(0,i.useState)(!1),{prependFileToTitle:A}=(0,p.Z)(e),{readFile:R,readdir:S}=(0,y.o)(),M=(0,i.useRef)(null),P=(0,i.useRef)(null),q=(0,i.useRef)(null),{reset:B,scale:I,zoomIn:H,zoomOut:D,zoomToPoint:U}=x(e,P.current,q.current),{fullscreenElement:O,toggleFullscreen:F}=(0,T.S)(),_=(0,i.useCallback)(async()=>{let e=await R(d),t=(0,k.RT)(d),n=await (0,C.decodeImageToBuffer)(t,e);v(r=>{let[a]=Object.keys(r);if(a){if(a===d)return r;null==B||B()}return{[d]:(0,k.wB)(t,n||e)}}),A((0,a.basename)(d))},[A,R,B,d]),K=(0,i.useCallback)(async({key:t})=>{switch(t){case"ArrowRight":case"ArrowLeft":{let r=await S((0,a.dirname)(d)),i=r.indexOf((0,a.basename)(d)),l=(t,i)=>{if(-1===t)return;let s=t+(i?1:-1);if(-1===s||s===r.length)return;let o=r[s];E.lM.has((0,k.RT)(o))?n(e,(0,a.join)((0,a.dirname)(d),o)):l(s,i)};l(i,"ArrowRight"===t)}}},[e,S,n,d]);return(0,i.useEffect)(()=>{!d||m[d]||h||_()},[h,_,m,d]),(0,i.useEffect)(()=>(null==c||c.addEventListener("keydown",K),()=>null==c?void 0:c.removeEventListener("keydown",K)),[c,K]),(0,r.jsxs)(f,{ref:M,$showImage:!!(m[d]&&!w),onContextMenu:k.nK,...(0,b.Z)({id:e}),children:[(0,r.jsxs)("nav",{className:"top",children:[(0,r.jsx)(j.Z,{disabled:!d||I===$||w,onClick:H,...(0,k.PS)("Zoom in"),children:(0,r.jsx)(o,{})}),(0,r.jsx)(j.Z,{disabled:!d||I===Z||w,onClick:D,...(0,k.PS)("Zoom out"),children:(0,r.jsx)(u,{})})]}),(0,r.jsxs)("figure",{ref:q,...(0,L.Z)(e=>{I===Z?null==U||U(2*Z,e,{animate:!0}):null==B||B()}),children:[(0,r.jsx)("img",{ref:P,alt:(0,a.basename)(d,(0,a.extname)(d)),decoding:"async",loading:"eager",onError:()=>z(!0),onLoad:()=>z(!1),src:m[d],...E.h7}),w&&(0,r.jsxs)("div",{children:[(0,a.basename)(d),(0,r.jsx)("br",{}),"Sorry, Photos can't open this file because the format is currently unsupported, or the file is corrupted"]})]}),(0,r.jsx)("nav",{className:"bottom",children:(0,r.jsx)(j.Z,{disabled:!d,onClick:()=>F(M.current,"show"),...(0,k.PS)("Full-screen"),children:O===M.current?(0,r.jsx)(s,{}):(0,r.jsx)(l,{})})})]})}},45279:function(e,t,n){var r=n(1864),a=n(67294),i=n(59746),l=n(23736),s=n(89670),o=n(20063),u=n(58437),c=n(76488),h=n(97836),d=n(6484);t.Z=({callback:e,directory:t=h.Ll,id:n,onDragLeave:f,onDragOver:m,updatePositions:v})=>{let{url:g}=(0,u.z)(),{iconPositions:p,sortOrders:w,setIconPositions:x}=(0,c.k)(),{exists:b,mkdirRecursive:y,updateFolder:T,writeFile:L}=(0,o.o)(),j=(0,a.useCallback)(async(e,t,a)=>{if(n){if(t){let i=(0,r.join)(h.Ll,e);if(await y(h.Ll),await L(i,t,!0))return a===s.v.UPDATE_URL&&g(n,i),T(h.Ll,e),(0,r.basename)(i)}else a===s.v.UPDATE_URL&&g(n,e)}return""},[n,y,T,g,L]),{openTransferDialog:E}=(0,i.Z)();return{onDragLeave:f,onDragOver:e=>{null==m||m(e),(0,d.nK)(e)},onDrop:a=>{if(!h.my.has((0,d.RT)(t))){if(v&&a.target instanceof HTMLElement){let{files:e,text:n}=(0,l.p4)(a);if(0===e.length&&""===n)return;let i={x:a.clientX,y:a.clientY},s=[];if(n){try{s=JSON.parse(n)}catch{}if(!Array.isArray(s))return;let[e]=s;if(!e||e.startsWith(t)&&(0,r.basename)(e)===(0,r.relative)(t,e))return;s=s.map(e=>(0,r.basename)(e))}else e instanceof FileList?s=[...e].map(e=>e.name):s=[...e].map(e=>{var t;return(null===(t=e.getAsFile())||void 0===t?void 0:t.name)||""}).filter(Boolean);s=s.map(e=>{if(!p[`${t}/${e}`])return e;let n=0,a="";do n+=1,a=`${t}/${(0,r.basename)(e,(0,r.extname)(e))} (${n})${(0,r.extname)(e)}`;while(p[a]);return(0,r.basename)(a)}),(0,d.vi)(t,a.target,p,w,i,s,x,b)}(0,l.WG)(a,e||j,t,E,!!n)}}}}},44696:function(e,t,n){var r=n(67294),a=n(58437),i=n(37176),l=n(97836);t.Z=e=>{let{title:t}=(0,a.z)(),[n]=e.split(l.CC),{title:s}=i.Z[n]||{};return{appendFileToTitle:(0,r.useCallback)((n,r)=>{let a=n?` - ${n}${r?` ${l.xy}`:""}`:"";t(e,`${s}${a}`)},[e,s,t]),prependFileToTitle:(0,r.useCallback)((n,r,a)=>{let i=n?`${r?`${l.xy} `:""}${n}${a?" ":" - "}`:"";t(e,`${i}${s}`)},[e,s,t])}}},24645:function(e,t,n){var r=n(67294),a=n(97836);t.Z=(e,t=!1)=>{let n=(0,r.useRef)(),i=(0,r.useRef)(0);return{onClick:(0,r.useCallback)(r=>{let l=()=>{r.stopPropagation(),e(r)},s=()=>{n.current&&(clearTimeout(n.current),n.current=void 0)},o=()=>{i.current>=12&&s(),void 0===n.current?(r.target.removeEventListener("pointermove",o),i.current=0):i.current+=1};t?l():void 0===n.current?(n.current=window.setTimeout(s,a.jx.DOUBLE_CLICK),r.target.addEventListener("pointermove",o,{passive:!0})):(s(),l())},[e,t])}}},72490:function(e,t,n){var r=n(67294);t.Z=(e,t)=>{let[n,a]=(0,r.useState)();(0,r.useEffect)(()=>{t&&a(new ResizeObserver(t))},[t]),(0,r.useEffect)(()=>(e instanceof HTMLElement&&(null==n||n.observe(e)),()=>{e instanceof HTMLElement&&(null==n||n.unobserve(e))}),[e,n])}},14609:function(e,t,n){n.d(t,{decodeImageToBuffer:function(){return g},getFirstAniImage:function(){return f},getLargestIcon:function(){return m}});var r=n(97836),a=n(48764).Buffer;function i(e,t=[]){let{length:n}=t,r=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)].concat(t);return[n>>24&255,n>>16&255,n>>8&255,255&n].concat(r,function(e){let t=[],n=0;for(let e=0;e<256;++e)n=1&(n=1&(n=1&(n=1&(n=1&(n=1&(n=1&(n=1&(n=e)?3988292384^n>>>1:n>>>1)?3988292384^n>>>1:n>>>1)?3988292384^n>>>1:n>>>1)?3988292384^n>>>1:n>>>1)?3988292384^n>>>1:n>>>1)?3988292384^n>>>1:n>>>1)?3988292384^n>>>1:n>>>1)?3988292384^n>>>1:n>>>1,t[e]=n;for(let r of(n=-1,e))n=n>>>8^t[(n^r)&255];return[(n^=-1)>>24&255,n>>16&255,n>>8&255,255&n]}(r))}let l=e=>a.from(new Uint8Array(function(e){if(e.length<22||113!==e[0]||111!==e[1]||105!==e[2]||102!==e[3])return;let t=e[4]<<24|e[5]<<16|e[6]<<8|e[7],n=e[12],r=e[13];if(3!==n&&4!==n&&1!==r)return;let a=e.length-8,l=[],s=Array.from({length:64}).fill(0),o=255,u=14;for(;u<a;){let t=e[u],n=t>>6;if(255===t){let t=e[u+1],n=e[u+2],r=e[u+3],a=e[u+4];u+=5,o=t<<24|n<<16|r<<8|a,s[(3*t+5*n+7*r+11*a)%64]=o,l.push(o)}else if(254===t){let t=e[u+1],n=e[u+2],r=e[u+3],a=255&o;u+=4,o=t<<24|n<<16|r<<8|a,s[(3*t+5*n+7*r+11*a)%64]=o,l.push(o)}else if(0===n){if(0===e[u]&&0===e[u+1]&&0===e[u+2]&&0===e[u+3]&&0===e[u+4]&&0===e[u+5]&&0===e[u+6]&&1===e[u+7])break;u+=1,o=s[t],l.push(o)}else if(1===n){let e=(o>>24&255)+((t>>4&3)-2)&255,n=(o>>16&255)+((t>>2&3)-2)&255,r=(o>>8&255)+((3&t)-2)&255,a=255&o;u+=1,o=e<<24|n<<16|r<<8|a,s[(3*e+5*n+7*r+11*a)%64]=o,l.push(o)}else if(2===n){let n=e[u+1],r=(63&t)-32&255,a=(n>>4&15)-8+r&255,i=(15&n)-8+r&255,c=(o>>24&255)+a&255,h=(o>>16&255)+r&255,d=(o>>8&255)+i&255,f=255&o;u+=2,o=c<<24|h<<16|d<<8|f,s[(3*c+5*h+7*d+11*f)%64]=o,l.push(o)}else{for(let e=(63&t)+1;e>0;--e)l.push(o);u+=1}}return function(e,t,n){let r=[],a=[120,1],l=1+t*n,s=65535^l;for(let i=0;e.length!=i;i+=t){let o=i+t;a.push(o===e.length?1:0,255&l,l>>8&255,255&s,s>>8&255),r.push(1),a.push(0);for(let t=i;o!==t;++t){let i=e[t];r.push(i>>24&255),a.push(i>>24&255),r.push(i>>16&255),a.push(i>>16&255),r.push(i>>8&255),a.push(i>>8&255),4===n&&(r.push(255&i),a.push(255&i))}}let o=e.length/t;return[137,80,78,71,13,10,26,10].concat(i("IHDR",[t>>24&255,t>>16&255,t>>8&255,255&t,o>>24&255,o>>16&255,o>>8&255,255&o,8,3===n?2:6,0,0,0]),i("IDAT",a.concat(function(e){let t=0,n=0;for(let r of e)n=(n+(t=(t+r)%65521))%65521;return[n>>8,255&n,t>>8,255&t]}(r))),i("IEND"))}(l,t,n)}(new Uint8Array(e))));var s=n(6484),o=n(48764).Buffer;let u=async e=>{let t=document.createElement("img");return document.createElement("picture").append(Object.assign(document.createElement("source"),{srcset:"data:,x",type:e}),t),await new Promise(e=>{requestAnimationFrame(e)}),"string"==typeof t.currentSrc&&t.currentSrc.length>0},c=async e=>await u("image/jxl")?e:new Promise(t=>{let n=new Worker("System/JXL.js/jxl_dec.js");n.postMessage({image:e,jxlSrc:"image.jxl"}),n.addEventListener("message",e=>{var n;return t((0,s.fv)(null==e?void 0:null===(n=e.data)||void 0===n?void 0:n.imgData))})}),h=async e=>await u("image/heic")?e:new Promise(t=>{let r=new Worker(n.tu(new URL(n.p+n.u(1337),n.b)),{name:"libheif"});r.postMessage(e),r.addEventListener("message",({data:e})=>t((0,s.fv)(e)))}),d=async e=>{let t=await (0,s.iQ)(),{parseAni:a}=await n.e(396,"high").then(n.bind(n,70396)),i=[];try{({images:i}=a(e))}catch{return e}return await Promise.all(i.map(e=>new Promise(n=>{let a=new Image,i=(0,s.YS)(o.from(e));t.setOptions({transparent:""}),a.addEventListener("load",()=>{t.addFrame(a),(0,s.EK)(i),n()},r.K7),a.src=i}))),new Promise(e=>{t.on("finished",t=>t.arrayBuffer().then(t=>e(o.from(t)))).render()})},f=async e=>{let t;let{parseAni:r}=await n.e(396,"high").then(n.bind(n,70396));try{return{images:[t]}=r(e),o.from(t)}catch{}},m=async(e,t)=>{try{let{default:r}=await n.e(5704,"high").then(n.t.bind(n,95704,23)),[a]=r(e).filter(({width:e})=>e<=t).sort((e,t)=>t.width-e.width),i=document.createElement("canvas"),l=i.getContext("2d",{desynchronized:!0});return i.width=a.width,i.height=a.height,null==l||l.putImageData(a,0,0),i.toDataURL()}catch{return""}},v=async(e,t)=>new Promise(n=>{let a=new Image;a.addEventListener("load",()=>n(!0),r.K7),a.addEventListener("error",()=>n(!1),r.K7),a.src=(0,s.wB)(e,t)}),g=async(e,t)=>{switch(e){case".jxl":return c(t);case".qoi":return l(t);case".ani":try{return d(t)}catch{return f(t)}case".cur":return await v(e,t)?t:f(t);default:if(r.Wr.has(e))return h(t);if(r.M0.has(e))return o.from((await n.e(6173,"high").then(n.t.bind(n,66173,23))).bufferToURI(t).replace("data:image/png;base64,",""),"base64")}return t}}}]);